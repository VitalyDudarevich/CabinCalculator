<!DOCTYPE html>
<html>
<head>
    <title>Test Statuses API</title>
</head>
<body>
    <h1>–¢–µ—Å—Ç API –°—Ç–∞—Ç—É—Å–æ–≤</h1>
    <button onclick="testAuth()">1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é</button>
    <button onclick="testStatuses()">2. –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç–∞—Ç—É—Å—ã</button>
    <button onclick="testStats()">3. –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</button>
    <div id="result" style="margin-top: 20px; padding: 10px; border: 1px solid #ccc; background: #f9f9f9;"></div>

    <script>
        const API_URL = 'http://localhost:5000/api';
        const companyId = '6861c12979deee9670a32df6';
        const token = localStorage.getItem('token');
        
        function log(message) {
            document.getElementById('result').innerHTML += '<div>' + message + '</div>';
        }
        
        function clearLog() {
            document.getElementById('result').innerHTML = '';
        }
        
        async function testAuth() {
            clearLog();
            log('üîë –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–∫–µ–Ω –∏–∑ localStorage...');
            log('Token: ' + (token ? '–Ω–∞–π–¥–µ–Ω' : '–ù–ï –ù–ê–ô–î–ï–ù'));
            
            if (!token) {
                log('‚ùå –¢–æ–∫–µ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ localStorage');
                return;
            }
            
            try {
                const response = await fetch(`${API_URL}/companies`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                log(`üì° –û—Ç–≤–µ—Ç /companies: ${response.status} ${response.statusText}`);
                
                if (response.ok) {
                    const data = await response.json();
                    log(`‚úÖ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è OK. –ù–∞–π–¥–µ–Ω–æ –∫–æ–º–ø–∞–Ω–∏–π: ${data.length}`);
                } else {
                    log(`‚ùå –û—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏: ${response.status}`);
                }
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞: ${error.message}`);
            }
        }
        
        async function testStatuses() {
            clearLog();
            log('üìä –¢–µ—Å—Ç–∏—Ä—É–µ–º –∑–∞–≥—Ä—É–∑–∫—É —Å—Ç–∞—Ç—É—Å–æ–≤...');
            
            if (!token) {
                log('‚ùå –¢–æ–∫–µ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω');
                return;
            }
            
            try {
                const response = await fetch(`${API_URL}/statuses?companyId=${companyId}`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                log(`üì° –û—Ç–≤–µ—Ç /statuses: ${response.status} ${response.statusText}`);
                
                if (response.ok) {
                    const data = await response.json();
                    log(`‚úÖ –°—Ç–∞—Ç—É—Å—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã: ${data.length} items`);
                    log(`üìã –ü–µ—Ä–≤—ã–π —Å—Ç–∞—Ç—É—Å: ${data[0]?.name || '–Ω–µ—Ç —Å—Ç–∞—Ç—É—Å–æ–≤'}`);
                } else {
                    const errorText = await response.text();
                    log(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç—É—Å–æ–≤: ${response.status}`);
                    log(`üìÑ –¢–µ–∫—Å—Ç –æ—à–∏–±–∫–∏: ${errorText}`);
                }
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞: ${error.message}`);
            }
        }
        
        async function testStats() {
            clearLog();
            log('üìà –¢–µ—Å—Ç–∏—Ä—É–µ–º –∑–∞–≥—Ä—É–∑–∫—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å—Ç–∞—Ç—É—Å–æ–≤...');
            
            if (!token) {
                log('‚ùå –¢–æ–∫–µ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω');
                return;
            }
            
            try {
                const response = await fetch(`${API_URL}/statuses/stats?companyId=${companyId}`, {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                log(`üì° –û—Ç–≤–µ—Ç /statuses/stats: ${response.status} ${response.statusText}`);
                
                if (response.ok) {
                    const data = await response.json();
                    log(`‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞: ${data.length} items`);
                    data.forEach((status, index) => {
                        log(`üìä ${index + 1}. ${status.name}: ${status.projectCount || 0} –ø—Ä–æ–µ–∫—Ç–æ–≤`);
                    });
                } else {
                    const errorText = await response.text();
                    log(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏: ${response.status}`);
                    log(`üìÑ –¢–µ–∫—Å—Ç –æ—à–∏–±–∫–∏: ${errorText}`);
                }
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞: ${error.message}`);
            }
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–∫–µ–Ω –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = function() {
            log('üöÄ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
            log('üîç –ö–æ–º–ø–∞–Ω–∏—è ID: ' + companyId);
        };
    </script>
</body>
</html> 